#!/bin/bash
# Install required packages via Homebrew (macOS)
# hash: {{ include ".chezmoiscripts/run_onchange_install-packages.sh.tmpl" | sha256sum }}

{{ if eq .chezmoi.os "darwin" -}}
echo "Installing packages via Homebrew..."

# Check if Homebrew is installed
if ! command -v brew &> /dev/null; then
    echo "Homebrew not found. Installing..."
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    eval "$(/opt/homebrew/bin/brew shellenv 2>/dev/null || /usr/local/bin/brew shellenv)"
fi

PACKAGES=(eza broot zoxide starship bat fzf neovim tmux git ripgrep fd k9s asdf dust duf httpie)

for pkg in "${PACKAGES[@]}"; do
    if ! brew list "$pkg" &>/dev/null; then
        echo "Installing $pkg..."
        brew install "$pkg" || echo "Warning: Failed to install $pkg"
    fi
done

echo "Package installation complete!"
{{ end -}}
